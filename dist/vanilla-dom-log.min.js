/**
  * vanilla-dom-log v4.0.0
  * (c) 2019 wizardpisces
  * @license MIT
  */
var global,factory;global=this,factory=function(){"use strict";var UID=Math.floor(1099511627776*Math.random()).toString(16),PLACE_HOLDER_REGEXP=new RegExp('"@__(F|R|D|M|S)-'+UID+'-(\\d+)__@"',"g"),IS_NATIVE_CODE_REGEXP=/\{\s*\[native code\]\s*\}/g,IS_PURE_FUNCTION=/function.*?\(/,UNSAFE_CHARS_REGEXP=/[<>\/\u2028\u2029]/g,RESERVED_SYMBOLS=["*","async"],ESCAPED_CHARS={"<":"\\u003C",">":"\\u003E","/":"\\u002F","\u2028":"\\u2028","\u2029":"\\u2029"};function escapeUnsafeChars(e){return ESCAPED_CHARS[e]}var serializeJavascript=function e(t,n){n||(n={}),"number"!=typeof n&&"string"!=typeof n||(n={space:n});var r,i=[],o=[],a=[],s=[],c=[];return"string"!=typeof(r=n.isJSON&&!n.space?JSON.stringify(t):JSON.stringify(t,n.isJSON?null:function(e,t){if(!t)return t;var n=this[e],r=typeof n;if("object"===r){if(n instanceof RegExp)return"@__R-"+UID+"-"+(o.push(n)-1)+"__@";if(n instanceof Date)return"@__D-"+UID+"-"+(a.push(n)-1)+"__@";if(n instanceof Map)return"@__M-"+UID+"-"+(s.push(n)-1)+"__@";if(n instanceof Set)return"@__S-"+UID+"-"+(c.push(n)-1)+"__@"}return"function"===r?"@__F-"+UID+"-"+(i.push(n)-1)+"__@":t},n.space))?String(r):(!0!==n.unsafe&&(r=r.replace(UNSAFE_CHARS_REGEXP,escapeUnsafeChars)),0===i.length&&0===o.length&&0===a.length&&0===s.length&&0===c.length?r:r.replace(PLACE_HOLDER_REGEXP,function(t,r,l){return"D"===r?'new Date("'+a[l].toISOString()+'")':"R"===r?o[l].toString():"M"===r?"new Map("+e(Array.from(s[l].entries()),n)+")":"S"===r?"new Set("+e(Array.from(c[l].values()),n)+")":function(e){var t=e.toString();if(IS_NATIVE_CODE_REGEXP.test(t))throw new TypeError("Serializing native function: "+e.name);if(IS_PURE_FUNCTION.test(t))return t;var n=t.indexOf("("),r=t.substr(0,n).trim().split(" ").filter(function(e){return e.length>0});return r.filter(function(e){return-1===RESERVED_SYMBOLS.indexOf(e)}).length>0?(r.indexOf("async")>-1?"async ":"")+"function"+(r.join("").indexOf("*")>-1?"*":"")+t.substr(n):t}(i[l])}))};function isObjectLike(e){return"object"==typeof e&&null!==e}function baseGetTag(e){return Object.prototype.toString.call(e)}function find(e,t){return e.filter(t)[0]}const deepCopyWithCircularReferenceReplaced=(cache=[],function e(t,n=!1){if(null===t||"object"!=typeof t)return t;const r=find(cache,e=>e.original===t);if(r)return n?"[circular structure]":r.copy;const i=Array.isArray(t)?[]:{};return cache.push({original:t,copy:i}),Object.keys(t).forEach(r=>{i[r]=e(t[r],n)}),n&&cache.pop(),i});var cache;const _={deepCopyWithCircularReferenceReplaced:deepCopyWithCircularReferenceReplaced,map(e,t){let n=_.isArray(e);return Object.keys(e).map(r=>t(e[r],n?parseInt(r):r))},isArray:e=>Array.isArray(e),isPlainObject(e){if(!isObjectLike(e)||"[object Object]"!=baseGetTag(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},isInteger:e=>Number.isInteger(e),isNumber:e=>"number"==typeof e,isNull:e=>"null"==typeof e,isString:e=>"string"==typeof e};function deserialize(serializedJavascript){return eval("("+serializedJavascript+")")}const _VallinaDomLogKey="_vanilla-dom-log-key";function isElement(e){try{return e instanceof HTMLElement}catch(t){return"object"==typeof e&&1===e.nodeType&&"object"==typeof e.style&&"object"==typeof e.ownerDocument}}const dom=new Proxy({},{get:(e,t)=>(function(e={},n){const r=document.createElement(t);for(let t in e)"style"===t?Object.keys(e.style).map(t=>{r.style[t]=e.style[t]}):"on"===t&&"object"==typeof e[t]?Object.keys(e[t]).map(n=>{r["on"+n]=e[t][n]}):r.setAttribute(t,e[t]);for(let e in n){let t=n[e];isElement(t)||(t=document.createTextNode(t)),r.appendChild(t)}return r})});function h(e,t={},n){return n=Array.isArray(n)?n:[],dom[e](t,n)}var cssText="\n\n.tree-view-wrapper {\n  overflow: auto;\n}\n\n/* Find the first nested node and override the indentation */\n.tree-view-item-root > .tree-view-item-leaf > .tree-view-item {\n  margin-left: 0!important;\n}\n\n/* Root node should not be indented */\n.tree-view-item-root {\n  margin-left: 0!important;\n}\n";function transformValue(e,t,n=!1){return{key:t,type:"value",isRoot:n,value:e}}function generateChildrenFromCollection(e){return _.map(e,(e,t)=>isObject(e)?transformObject(e,t):isArray(e)?transformArray(e,t):isValue(e)?transformValue(e,t):void 0)}function transformArray(e,t){return{key:t,type:"array",children:generateChildrenFromCollection(e)}}function transformObject(e,t,n=!1){return{key:t,type:"object",isRoot:n,children:generateChildrenFromCollection(e)}}function isObject(e){return _.isPlainObject(e)}function isArray(e){return _.isArray(e)}function isValue(e){return!isObject(e)&&!isArray(e)}function parsedData(e){return isValue(e=_.deepCopyWithCircularReferenceReplaced(e,[],!0))?transformValue(e,"root",!0):transformObject(e,"root",!0)}class TreeView extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"});e.append(h("style",{type:"text/css"},[cssText])),this.treeViewDom=h("div",{class:"tree-view-wrapper"}),e.appendChild(this.treeViewDom)}connectedCallback(){this.render(this.data)}disconnectedCallback(){console.log("disconnected!")}get data(){return this.cached||(this.cached=deserialize(this.getAttribute("data"))),this.cached}static get observedAttributes(){return["data"]}render(e){e=parsedData(e),this.treeViewDom.replaceWith(h("div",{class:"tree-view-wrapper"},[h("tree-view-item",{class:"tree-view-item-root",data:serializeJavascript(e)})]))}}function isObject$1(e){return"object"===e.type}function isArray$1(e){return"array"===e.type}function isValue$1(e){return"value"===e.type}function getKey(e){return _.isInteger(e.key)?e.key+":":'"'+e.key+'":'}var cssText$1=`\n    .tree-view-item {\n        font-family: monaco, monospace;\n        font-size: 14px;\n        margin-left: 18px;\n    }\n\n    .tree-view-item-node {\n        cursor: pointer;\n        position: relative;\n        white-space: nowrap;\n    }\n\n    .tree-view-item-leaf {\n        white-space: nowrap;\n    }\n\n    .tree-view-item-key {\n        font-weight: bold;\n    }\n\n    .tree-view-item-key-with-chevron {\n        padding-left: 14px;\n    }\n\n\n    .tree-view-item-key-with-chevron.opened::before {\n        top:4px;\n        transform: rotate(90deg);\n        -webkit-transform: rotate(90deg);\n    }\n\n    .tree-view-item-key-with-chevron::before {\n        color: #444;\n        content: '${String.fromCodePoint(9654)}';\n        font-size: 10px;\n        left: 1px;\n        position: absolute;\n        top: 3px;\n        transition: -webkit-transform .1s ease;\n        transition: transform .1s ease;\n        transition: transform .1s ease, -webkit-transform .1s ease;\n        -webkit-transition: -webkit-transform .1s ease;\n    }\n\n    .tree-view-item-hint {\n        color: #ccc\n    }\n`;class TreeViewItem extends HTMLElement{constructor(){super(),this.open=!1;const e=this.attachShadow({mode:"open"});e.append(h("style",{type:"text/css"},[cssText$1])),this.template=h("div",{class:"tree-view-item"}),e.appendChild(this.template)}connectedCallback(){this.render(this.data)}static get observedAttributes(){return["data"]}get data(){return this.cached||(this.cached=deserialize(this.getAttribute("data"))),this.cached}render(e){this.template.replaceWith(this.template=h("div",{class:"tree-view-item"},[this.getProperTreeViewItem(e)]))}toggleOpen(){this.open=!this.open,this.render(this.data)}getProperTreeViewItem(e){if(isObject$1(e)||isArray$1(e)){let t=this.open?e.children.map(e=>h("tree-view-item",{data:serializeJavascript(e)})):[];return h("div",{class:"tree-view-item-leaf"},[function(e){let t=isObject$1(e)?e.children.length>1?" Object{...}":"Object":isArray$1(e)?e.children.length>1?" Array[...]":"Array":"";return h("div",{class:"tree-view-item-node",on:{click:this.toggleOpen.bind(this)}},[h("span",{class:"tree-view-item-key tree-view-item-key-with-chevron "+(this.open?"opened":"")},[e.isRoot?"":getKey(e)]),h("span",{class:"tree-view-item-hint"},[e.children.length+" "+t])])}.call(this,e),...t])}return isValue$1(e)?h("tree-view-item-value",{class:"tree-view-item-leaf",data:serializeJavascript(e)}):"[ TreeViewBug ] :unknown_data_type"}}class TreeViewItem$1 extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"});this.template=h("div",{class:"tree-view-item-value"}),e.appendChild(this.template)}connectedCallback(){this.render(this.data)}static get observedAttributes(){return["data"]}get data(){return this.cached||(this.cached=deserialize(this.getAttribute("data"))),this.cached}getValue(e){return _.isNumber(e)?e:_.isNull(e)?"null":_.isString(e)?'"'+e+'"':e}render(e){this.template.replaceWith(h("div",{class:"tree-view-item-value"},[h("span",{class:"tree-view-item-key"},[e.isRoot?"":getKey(e)]),h("span",{class:"value"},[this.getValue(e.value)])]))}}function renderJsonTree(e){return h("tree-view",{data:serializeJavascript(e)})}customElements.define("tree-view-item-value",TreeViewItem$1),customElements.define("tree-view-item",TreeViewItem),customElements.define("tree-view",TreeView);let rootClass=_VallinaDomLogKey;var cssText$2=`\n.${rootClass}{\n    position: fixed;\n    top: 0;\n    height: 400px;\n    overflow: scroll;\n    z-index: 9999;\n    padding: 10px;\n}\n.${rootClass} li {\n     display: flex;\n     border-bottom:0.5px solid #ccc;\n }\n`;let logRootWrapper=h("ul",{class:_VallinaDomLogKey});class DomShadowRoot extends HTMLElement{constructor(){super();let e=this.attachShadow({mode:"open"});e.append(h("style",{type:"text/css"},[cssText$2])),e.append(logRootWrapper)}}customElements.define("dom-shadow-root",DomShadowRoot),document.getElementsByTagName("body")[0].appendChild(h("dom-shadow-root"));const CONSOLE_RESOURCE_MAP={error:{color:"red"},log:{color:"#000"}},ORIGINAL_CONSOLE_METHOD_MAP={},METHODS=Object.keys(CONSOLE_RESOURCE_MAP);METHODS.forEach(e=>{ORIGINAL_CONSOLE_METHOD_MAP[e]=console[e]});class VanillaDomConsole{constructor(e={max_history_length:10,customStyle:{},logRoot:logRootWrapper}){this._historyLogs=new Proxy(this._getHistoryLogs(),{get:(e,t)=>e[t],set:(t,n,r)=>(t[n]=r,localStorage.setItem(_VallinaDomLogKey,serializeJavascript(t.slice(-e.max_history_length))),!0)}),this.logRoot=e.logRoot,this._batchPaintLog(this._historyLogs)}delegate(){return this.undelegate=createProxyMap(this._proxyLog.bind(this))}_getHistoryLogs(){return deserialize(localStorage.getItem(_VallinaDomLogKey))||[]}_batchPaintLog(e){let t=document.createDocumentFragment();e.forEach(e=>{t.appendChild(h("li",{color:CONSOLE_RESOURCE_MAP[e.method].color},formatLog(...e.logs)))}),this.logRoot.appendChild(t)}_paintLog(e){this.logRoot.appendChild(h("li",{color:CONSOLE_RESOURCE_MAP[e.method].color},formatLog(...e.logs)))}_proxyLog(e){this._historyLogs.push(e),this._paintLog(e)}}function createProxyMap(e){return METHODS.forEach(t=>{console[t]=(...n)=>{e({method:t,logs:n.map(e=>_.deepCopyWithCircularReferenceReplaced(e,!0))}),ORIGINAL_CONSOLE_METHOD_MAP[t].apply(null,n)}}),function(){METHODS.forEach(e=>{console[e]=ORIGINAL_CONSOLE_METHOD_MAP[e]})}}function formatLog(...e){return e.map(e=>renderJsonTree(e))}function getInstance(){let e=null;return t=>(e||(e=new VanillaDomConsole(t)),e)}var index=getInstance();return index},"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):(global=global||self).VanillaDomLog=factory();